<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>반복측정/다시점 자료 분석 가이드</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- MathJax CDN for LaTeX rendering -->
    <script type="text/javascript" async
      src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]},
        "HTML-CSS": {
          scale: 120, /* Increase font size for HTML-CSS output */
          linebreaks: { automatic: true }
        },
        SVG: {
          scale: 120, /* Increase font size for SVG output */
          linebreaks: { automatic: true }
        }
      });
    </script>
    <!-- Chosen Palette: Calm Harmony -->
    <!-- Application Structure Plan: 이 애플리케이션은 사용자가 비선형적으로 정보를 탐색할 수 있도록 8개의 주요 섹션(소개, 방법 비교, RM ANOVA 가정, LMM 심층 이해, GEE 심층 이해, R 실습 가이드, 사례 연구, 필요 패키지, 핵심 요약)으로 구성된 주제별 대시보드 구조를 채택함. 상단 탐색 메뉴를 통해 각 섹션으로 빠르게 이동할 수 있음. '방법 비교' 섹션은 분석 기법 비교표와 의사결정 가이드만을 포함하여 간소화됨. 'RM ANOVA 가정', 'LMM 심층 이해', 'GEE 심층 이해' 섹션은 각 분석 방법의 모델 식, 특징, 가정 등을 자세히 설명함. 'R 실습 가이드' 섹션은 각 분석 방법별로 R 코드 예제를 제공하여 실습에 도움을 줌. '사례 연구' 섹션은 드롭다운 메뉴를 통해 사용자가 원하는 연구를 선택하고, 해당 연구의 데이터 시각화와 해석을 동적으로 확인할 수 있도록 설계됨. '필요 패키지' 섹션은 각 분석에 필요한 R 패키지들을 설명함. 이러한 구조는 정적인 보고서 형식에서 벗어나 사용자 주도적인 학습 경험을 제공하고, 복잡한 통계 개념의 비교와 합성을 용이하게 하기 때문에 선택됨. -->
    <!-- Visualization & Content Choices: 텍스트 정보는 카드와 목록을 사용하여 구조화되었으며, 분석 방법 선택을 돕기 위한 '의사결정 가이드'는 순서도로 시각화하여 직관성을 높임(HTML/CSS 활용). 세 가지 사례 연구(TLC, BPRS, 아동 건강)의 핵심 결과는 Chart.js를 이용한 대화형 선 그래프와 막대그래프로 시각화하여 시간 경과에 따른 변화와 그룹 간 차이를 명확하게 보여줌. 이 방식은 사용자가 데이터를 직접 탐색하며 통계적 결과를 더 깊이 이해하도록 도움. 모든 시각화는 SVG나 Mermaid JS 없이 Canvas와 순수 HTML/CSS로 구현됨. R 실습 가이드에는 R 코드 블록과 R Plot의 개념을 나타내는 Placeholder 이미지를 삽입하여 단계별 설명을 시각적으로 보강함. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: #f8fafc;
            color: #334155;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
            height: 40vh;
            max-height: 450px;
        }
        .nav-link {
            transition: all 0.3s ease;
        }
        .nav-link.active {
            color: #2563eb;
            border-bottom-color: #2563eb;
        }
        .tab-btn.active {
            background-color: #3b82f6;
            color: #ffffff;
        }
        .content-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }
        .spss-image {
            max-width: 100%;
            height: auto;
            border-radius: 0.75rem; /* rounded-xl */
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1); /* shadow-md */
            margin-top: 1.5rem; /* mt-6 */
            margin-bottom: 1.5rem; /* mb-6 */
        }
        pre {
            background-color: #f1f5f9; /* slate-100 */
            padding: 1rem;
            border-radius: 0.5rem; /* rounded-md */
            overflow-x: auto;
            font-size: 0.875rem; /* text-sm */
            line-height: 1.5;
            color: #334155; /* slate-800 */
        }
        code {
            font-family: monospace;
        }
    </style>
</head>
<body class="bg-slate-50">

    <header class="bg-white/80 backdrop-blur-md shadow-sm sticky top-0 z-50">
        <nav class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex-shrink-0">
                    <h1 class="text-xl font-bold text-blue-600">다시점 자료 분석</h1>
                </div>
                <div class="hidden md:block">
                    <div class="ml-10 flex items-baseline space-x-4">
                        <a href="#intro" class="nav-link text-gray-500 hover:text-blue-600 px-3 py-2 rounded-md text-sm font-medium border-b-2 border-transparent">소개</a>
                        <a href="#comparison" class="nav-link text-gray-500 hover:text-blue-600 px-3 py-2 rounded-md text-sm font-medium border-b-2 border-transparent">방법 비교</a>
                        <a href="#rm-anova-assumptions" class="nav-link text-gray-500 hover:text-blue-600 px-3 py-2 rounded-md text-sm font-medium border-b-2 border-transparent">RM ANOVA</a>
                        <a href="#lmm-deep-dive" class="nav-link text-gray-500 hover:text-blue-600 px-3 py-2 rounded-md text-sm font-medium border-b-2 border-transparent">LMM</a>
                        <a href="#gee-deep-dive" class="nav-link text-gray-500 hover:text-blue-600 px-3 py-2 rounded-md text-sm font-medium border-b-2 border-transparent">GEE</a>
                        <a href="#r-guides" class="nav-link text-gray-500 hover:text-blue-600 px-3 py-2 rounded-md text-sm font-medium border-b-2 border-transparent">R 실습</a>
                        <a href="#case-studies" class="nav-link text-gray-500 hover:text-blue-600 px-3 py-2 rounded-md text-sm font-medium border-b-2 border-transparent">사례</a>
                        <a href="#required-packages" class="nav-link text-gray-500 hover:text-blue-600 px-3 py-2 rounded-md text-sm font-medium border-b-2 border-transparent">필요 패키지</a>
                        <a href="#summary" class="nav-link text-gray-500 hover:text-blue-600 px-3 py-2 rounded-md text-sm font-medium border-b-2 border-transparent">요약</a>
                    </div>
                </div>
            </div>
        </nav>
    </header>

    <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-8 md:py-12">
        
        <section id="intro" class="mb-16 scroll-mt-20">
            <h2 class="text-3xl font-bold text-slate-800 mb-4 text-center">다시점 자료(Repeated Measures Data)란?</h2>
            <p class="text-lg text-slate-600 max-w-3xl mx-auto text-center mb-8">동일한 대상으로부터 시간의 흐름에 따라 반복적으로 측정된 데이터를 의미함. 이러한 데이터는 개체 내 측정값들 사이에 상관관계가 존재한다는 중요한 특징을 가짐.</p>
            <div class="grid md:grid-cols-2 gap-8 items-center">
                <div class="bg-white p-6 rounded-xl shadow-md content-card">
                    <h3 class="font-bold text-xl mb-3 text-blue-700">주요 특징</h3>
                    <ul class="space-y-3">
                        <li class="flex items-start">
                            <span class="text-blue-500 mr-3 mt-1">✓</span>
                            <div>
                                <h4 class="font-semibold">개체 내 상관성</h4>
                                <p class="text-slate-500 text-sm">한 대상에서 측정된 값들은 서로 독립적이지 않음. 예를 들어, 오늘의 혈압은 어제의 혈압과 관련이 있음.</p>
                            </div>
                        </li>
                        <li class="flex items-start">
                            <span class="text-blue-500 mr-3 mt-1">✓</span>
                            <div>
                                <h4 class="font-semibold">개체 간 독립성</h4>
                                <p class="text-slate-500 text-sm">서로 다른 대상의 측정값들은 독립적임. A 환자의 데이터는 B 환자의 데이터에 영향을 주지 않음.</p>
                            </div>
                        </li>
                    </ul>
                </div>
                <div class="bg-blue-50 p-6 rounded-xl text-center">
                     <div class="flex justify-center items-center space-x-4">
                        <div class="flex flex-col items-center">
                            <div class="w-16 h-16 bg-blue-200 rounded-full flex items-center justify-center font-bold text-blue-800">환자 A</div>
                            <p class="text-sm mt-2">Subject</p>
                        </div>
                        <div class="text-2xl text-blue-400 font-light">→</div>
                        <div class="flex space-x-2">
                            <div class="p-3 bg-white rounded-lg shadow-sm">1주차</div>
                            <div class="p-3 bg-white rounded-lg shadow-sm">2주차</div>
                            <div class="p-3 bg-white rounded-lg shadow-sm">3주차</div>
                        </div>
                    </div>
                    <p class="mt-4 text-slate-600 font-medium">이러한 데이터 구조 때문에 일반적인 통계 분석이 아닌, 반복측정을 고려한 특별한 분석 방법이 필요함.</p>
                </div>
            </div>
        </section>

        <section id="comparison" class="mb-16 scroll-mt-20">
            <h2 class="text-3xl font-bold text-slate-800 mb-2 text-center">분석 방법 비교</h2>
            <p class="text-lg text-slate-600 max-w-3xl mx-auto text-center mb-8">데이터의 특성과 연구 목적에 따라 적절한 분석 방법을 선택해야 함.</p>
            <div class="flex justify-center mb-6">
                <div id="tab-buttons" class="flex space-x-2 bg-slate-200 p-1 rounded-full">
                    <button class="tab-btn px-4 py-2 text-sm font-semibold rounded-full transition" data-tab="rm-anova-tab">RM ANOVA</button>
                    <button class="tab-btn px-4 py-2 text-sm font-semibold rounded-full transition" data-tab="lmm-tab">LMM</button>
                    <button class="tab-btn px-4 py-2 text-sm font-semibold rounded-full transition" data-tab="gee-tab">GEE</button>
                </div>
            </div>
            <div id="tab-content">
                <div id="rm-anova-tab" class="tab-pane hidden">
                    <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <div class="bg-white p-6 rounded-xl shadow-md content-card">
                            <h3 class="font-bold text-xl mb-2 text-blue-700">RM ANOVA</h3>
                            <p class="text-sm text-slate-500 mb-4">전통적인 반복측정 분산분석 방법임.</p>
                            <h4 class="font-semibold mb-2">언제 사용해야 하는가?</h4>
                            <p class="text-sm bg-blue-50 text-blue-800 p-2 rounded-md">결과 변수가 연속형이고, 결측치가 없는 완전한 데이터일 때 사용함.</p>
                        </div>
                        <div class="bg-white p-6 rounded-xl shadow-md content-card">
                            <h4 class="font-semibold mb-2">주요 특징</h4>
                            <ul class="list-disc list-inside text-sm space-y-1 text-slate-600">
                                <li>그룹, 시간, 그룹*시간 상호작용 효과 검증</li>
                                <li class="text-red-600">결측치가 있는 경우 해당 개체 제외</li>
                                <li>통계적 가정이 엄격함</li>
                            </ul>
                        </div>
                        <div class="bg-white p-6 rounded-xl shadow-md content-card">
                            <h4 class="font-semibold mb-2">핵심 가정</h4>
                            <ul class="list-disc list-inside text-sm space-y-1 text-slate-600">
                                <li>정규성 (Normality)</li>
                                <li>등분산성 (Homogeneity of Variance)</li>
                                <li>구형성 (Sphericity)</li>
                            </ul>
                            <a href="#rm-anova-assumptions" class="text-blue-600 hover:underline text-sm font-semibold mt-3 inline-block">자세히 알아보기 →</a>
                        </div>
                    </div>
                </div>
                <div id="lmm-tab" class="tab-pane hidden">
                     <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <div class="bg-white p-6 rounded-xl shadow-md content-card">
                            <h3 class="font-bold text-xl mb-2 text-green-700">LMM (선형 혼합 모형)</h3>
                            <p class="text-sm text-slate-500 mb-4">RM ANOVA의 한계를 극복한 유연한 분석 방법임.</p>
                            <h4 class="font-semibold mb-2">언제 사용해야 하는가?</h4>
                            <p class="text-sm bg-green-50 text-green-800 p-2 rounded-md">결과 변수가 연속형이며, 결측치가 있거나 개체별 차이를 고려해야 할 때 사용함.</p>
                        </div>
                        <div class="bg-white p-6 rounded-xl shadow-md content-card">
                            <h4 class="font-semibold mb-2">주요 특징</h4>
                            <ul class="list-disc list-inside text-sm space-y-1 text-slate-600">
                                <li>결측치가 있어도 분석 가능</li>
                                <li>개체별 특성(랜덤 효과)을 모형에 반영</li>
                                <li>다양한 상관 구조 설정 가능</li>
                            </ul>
                        </div>
                        <div class="bg-white p-6 rounded-xl shadow-md content-card">
                            <h4 class="font-semibold mb-2">핵심 개념</h4>
                            <ul class="list-disc list-inside text-sm space-y-1 text-slate-600">
                                <li>고정 효과 (Fixed Effects): 그룹, 시간 등</li>
                                <li>랜덤 효과 (Random Effects): 환자별 초기값, 변화율 등</li>
                            </ul>
                            <a href="#lmm-deep-dive" class="text-blue-600 hover:underline text-sm font-semibold mt-3 inline-block">자세히 알아보기 →</a>
                        </div>
                    </div>
                </div>
                <div id="gee-tab" class="tab-pane hidden">
                    <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <div class="bg-white p-6 rounded-xl shadow-md content-card">
                            <h3 class="font-bold text-xl mb-2 text-purple-700">GEE (일반화 추정 방정식)</h3>
                            <p class="text-sm text-slate-500 mb-4">다양한 유형의 결과 변수에 적용 가능한 강력한 분석 방법임.</p>
                            <h4 class="font-semibold mb-2">언제 사용해야 하는가?</h4>
                            <p class="text-sm bg-purple-50 text-purple-800 p-2 rounded-md">결과 변수가 범주형(예: 예/아니오)이거나 정규분포를 따르지 않을 때 사용함.</p>
                        </div>
                        <div class="bg-white p-6 rounded-xl shadow-md content-card">
                            <h4 class="font-semibold mb-2">주요 특징</h4>
                            <ul class="list-disc list-inside text-sm space-y-1 text-slate-600">
                                <li>연속형, 범주형 변수 모두 분석 가능</li>
                                <li>결측치가 있어도 분석 가능</li>
                                <li>모집단 전체의 평균적인 변화에 초점</li>
                            </ul>
                        </div>
                        <div class="bg-white p-6 rounded-xl shadow-md content-card">
                            <h4 class="font-semibold mb-2">핵심 개념</h4>
                            <ul class="list-disc list-inside text-sm space-y-1 text-slate-600">
                                <li>모집단 평균 추론 (Population-average)</li>
                                <li>랜덤 효과는 직접 고려하지 않음</li>
                            </ul>
                            <a href="#gee-deep-dive" class="text-blue-600 hover:underline text-sm font-semibold mt-3 inline-block">자세히 알아보기 →</a>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="rm-anova-assumptions" class="mb-16 scroll-mt-20">
            <h2 class="text-3xl font-bold text-slate-800 mb-4 text-center">RM ANOVA </h2>
            <p class="text-lg text-slate-600 max-w-3xl mx-auto text-center mb-8">RM ANOVA는 강력한 분석 도구이지만, 정확한 결과를 위해서는 몇 가지 중요한 가정을 충족해야 함.</p>

            <div class="grid md:grid-cols-1 gap-8">
                <div class="bg-white p-6 rounded-xl shadow-md content-card">
                    <h4 class="font-semibold text-blue-700 text-xl mb-2">RM ANOVA 모델 식</h4>
                    <p class="text-slate-600 text-sm mb-4">RM ANOVA의 일반적인 모델 식은 다음과 같음. 여기서 각 항은 종속 변수에 미치는 영향을 나타냄.</p>
                    <div class="bg-blue-50 p-4 rounded-md">
                        <p class="text-slate-700 text-sm">
                            $$ Y_{ijk} = \mu + \alpha_i + \tau_j + (\alpha\tau)_{ij} + \pi_k + \epsilon_{ijk} $$
                            여기서:
                            <ul class="list-disc list-inside ml-5 mt-2 space-y-1">
                                <li>$Y_{ijk}$: $k$번째 개체의 $i$번째 그룹에서 $j$번째 시점의 측정값</li>
                                <li>$\mu$: 전체 평균</li>
                                <li>$\alpha_i$: $i$번째 그룹의 고정 효과 (그룹 간 효과)</li>
                                <li>$\tau_j$: $j$번째 시점의 고정 효과 (시간 효과)</li>
                                <li>$(\alpha\tau)_{ij}$: $i$번째 그룹과 $j$번째 시점 간의 상호작용 효과</li>
                                <li>$\pi_k$: $k$번째 개체의 랜덤 효과 (개체 간 변동)</li>
                                <li>$\epsilon_{ijk}$: 오차 항 (개체 내 변동)</li>
                            </ul>
                        </p>
                    </div>
                </div>
            </div>
            <div class="grid md:grid-cols-3 gap-8 mt-8">
                <div class="bg-white p-6 rounded-xl shadow-md content-card">
                    <h3 class="font-bold text-xl mb-3 text-blue-700">1. 정규성 (Normality)</h3>
                    <p class="text-slate-600 text-sm mb-4">각 시점의 종속 변수(결과 변수)가 정규 분포를 따른다는 가정임. 특히 표본 크기가 작을 때 중요함.</p>
                    <div class="bg-blue-50 p-3 rounded-md mb-3">
                        <h4 class="font-semibold text-blue-800 text-sm mb-1">확인 방법:</h4>
                        <ul class="list-disc list-inside text-xs text-blue-700">
                            <li>Shapiro-Wilk 검정</li>
                            <li>Kolmogorov-Smirnov 검정</li>
                            <li>히스토그램 또는 Q-Q 플롯 시각적 확인</li>
                        </ul>
                    </div>
                    <p class="text-slate-500 text-xs">
                        $H_0$: 정규성 가정을 만족함 ($P \ge 0.05$) <br>
                        $H_1$: 정규성 가정을 만족하지 않음 ($P < 0.05$)
                    </p>
                </div>

                <div class="bg-white p-6 rounded-xl shadow-md content-card">
                    <h3 class="font-bold text-xl mb-3 text-blue-700">2. 등분산성 (Homogeneity of Variance)</h3>
                    <p class="text-slate-600 text-sm mb-4">각 그룹 내에서 종속 변수의 분산이 동일하다는 가정임.</p>
                    <div class="bg-blue-50 p-3 rounded-md mb-3">
                        <h4 class="font-semibold text-blue-800 text-sm mb-1">확인 방법:</h4>
                        <ul class="list-disc list-inside text-xs text-blue-700">
                            <li>Box의 공분산 행렬 등식 검정 (Box's M test)</li>
                            <li>Levene의 등분산 검정 (일반적인 ANOVA에서 사용)</li>
                        </ul>
                    </div>
                    <p class="text-slate-500 text-xs">
                        $H_0$: 그룹 간 분산 구조는 동일함 ($P \ge 0.05$) <br>
                        $H_1$: 그룹 간 분산 구조는 동일하지 않음 ($P < 0.05$)
                    </p>
                </div>

                <div class="bg-white p-6 rounded-xl shadow-md content-card">
                    <h3 class="font-bold text-xl mb-3 text-blue-700">3. 구형성 (Sphericity)</h3>
                    <p class="text-slate-600 text-sm mb-4">반복 측정된 각 시점 간의 차이 변수(예: Time1-Time2, Time1-Time3, Time2-Time3)들의 분산이 서로 동일하다는 가정임. 이 가정이 RM ANOVA의 가장 중요한 특징 중 하나임.</p>
                    <div class="bg-blue-50 p-3 rounded-md mb-3">
                        <h4 class="font-semibold text-blue-800 text-sm mb-1">확인 방법:</h4>
                        <ul class="list-disc list-inside text-xs text-blue-700">
                            <li>Mauchly의 단위행렬 검정 (Mauchly's Test of Sphericity)</li>
                        </ul>
                    </div>
                    <p class="text-slate-500 text-xs mb-2">
                        $H_0$: 구형성 가정을 만족함 ($P \ge 0.05$) <br>
                        $H_1$: 구형성 가정을 만족하지 않음 ($P < 0.05$)
                    </p>
                    <p class="text-red-600 text-xs font-semibold">
                        ⚠️ **가정 위배 시 대처:**<br>
                        $P < 0.05$일 경우, Greenhouse-Geisser 또는 Huynh-Feldt 수정값을 적용한 일변량 분석 결과를 사용하거나, 다변량 검정(Pillai's Trace, Wilks' Lambda 등) 결과를 해석함.
                    </p>
                </div>
            </div>
        </section>

        <section id="lmm-deep-dive" class="mb-16 scroll-mt-20">
            <h2 class="text-3xl font-bold text-slate-800 mb-4 text-center">LMM (선형 혼합 모형) 심층 이해</h2>
            <p class="text-lg text-slate-600 max-w-3xl mx-auto text-center mb-8">선형 혼합 모형(Linear Mixed Model, LMM)은 반복측정 데이터의 복잡한 구조를 효과적으로 다룰 수 있는 유연한 통계 모형임. 특히 개체 간의 이질성과 개체 내 측정값 간의 상관성을 동시에 고려할 수 있다는 장점이 있음.</p>

            <div class="grid md:grid-cols-1 gap-8">
                <div class="bg-white p-6 rounded-xl shadow-md content-card">
                    <h3 class="font-bold text-xl mb-3 text-green-700">선형 모형(Linear Model)과 LMM의 수식</h3>
                    <p class="text-slate-600 text-sm mb-4">선형 모형은 독립 변수와 종속 변수 간의 선형 관계를 가정함. LMM은 여기에 랜덤 효과 항을 추가하여 더 복잡한 데이터 구조를 설명함.</p>
                    <div class="bg-green-50 p-4 rounded-md mb-4">
                        <h4 class="font-semibold text-green-800 text-base mb-2">일반 선형 모형 (Linear Model, LM)</h4>
                        <p class="text-slate-700 text-sm">
                            $$ Y_i = \beta_0 + \beta_1 X_{1i} + \dots + \beta_p X_{pi} + \epsilon_i $$
                            여기서 $Y_i$는 종속 변수, $X$는 독립 변수, $\beta$는 고정 효과 계수, $\epsilon_i$는 오차 항임. 모든 관측치는 독립적이라고 가정함.
                        </p>
                    </div>
                    <div class="bg-green-50 p-4 rounded-md">
                        <h4 class="font-semibold text-green-800 text-base mb-2">선형 혼합 모형 (Linear Mixed Model, LMM)</h4>
                        <p class="text-slate-700 text-sm">
                            $$ Y_{ijk} = (\beta_0 + b_{0k}) + (\beta_1 + b_{1k}) X_{1ijk} + \dots + \beta_p X_{pijk} + \epsilon_{ijk} $$
                            또는 더 일반적으로:
                            $$ \mathbf{Y}_k = \mathbf{X}_k \boldsymbol{\beta} + \mathbf{Z}_k \mathbf{b}_k + \boldsymbol{\epsilon}_k $$
                            여기서:
                            <ul class="list-disc list-inside ml-5 mt-2 space-y-1">
                                <li>$Y_{ijk}$: $k$번째 개체의 $i$번째 그룹에서 $j$번째 시점의 측정값</li>
                                <li>$\boldsymbol{\beta}$: **고정 효과(Fixed Effects)** 벡터</li>
                                <li>$\mathbf{b}_k$: $k$번째 개체의 **랜덤 효과(Random Effects)** 벡터 (평균이 0인 정규 분포를 따른다고 가정함)</li>
                                <li>$\mathbf{X}_k$: 고정 효과와 관련된 디자인 행렬</li>
                                <li>$\mathbf{Z}_k$: 랜덤 효과와 관련된 디자인 행렬</li>
                                <li>$\boldsymbol{\epsilon}_k$: 오차 항 벡터 (평균이 0인 정규 분포를 따르며, 개체 내 측정값 간의 상관성을 가짐)</li>
                            </ul>
                            LMM은 고정 효과와 랜덤 효과를 모두 포함하여, 개체 간의 평균적인 관계와 개체별 특이적인 변동을 동시에 모델링함.
                        </p>
                    </div>
                </div>

                <div class="bg-white p-6 rounded-xl shadow-md content-card">
                    <h3 class="font-bold text-xl mb-3 text-green-700">고정 효과 (Fixed Effects)</h3>
                    <p class="text-slate-600 text-sm mb-4">고정 효과는 연구자가 특정 수준(level)에 관심이 있고, 그 수준들이 모집단 전체를 대표한다고 가정하는 요인들임. 즉, 이 요인들의 효과는 특정 값으로 고정되어 있으며, 다른 연구에서도 동일하게 적용될 것으로 기대됨.</p>
                    <ul class="list-disc list-inside ml-5 space-y-2 text-slate-700">
                        <li>**예시**:
                            <ul class="list-disc list-inside ml-5 mt-1">
                                <li>**성별**: 남성/여성이라는 특정 범주</li>
                                <li>**치료 그룹**: 신약 그룹/위약 그룹과 같이 연구자가 직접 설계한 그룹</li>
                                <li>**시간**: 특정 시점(예: 0주차, 4주차, 8주차)의 효과</li>
                            </ul>
                        </li>
                        <li>**특징**:
                            <ul class="list-disc list-inside ml-5 mt-1">
                                <li>일반적으로 **평균 차이**나 **회귀 계수**로 해석됨.</li>
                                <li>모집단 전체에 대한 일반화가 목적임.</li>
                            </ul>
                        </li>
                    </ul>
                </div>

                <div class="bg-white p-6 rounded-xl shadow-md content-card">
                    <h3 class="font-bold text-xl mb-3 text-green-700">랜덤 효과 (Random Effects)</h3>
                    <p class="text-slate-600 text-sm mb-4">랜덤 효과는 연구자가 특정 수준 자체보다는 그 수준들이 파생된 더 큰 모집단에 관심이 있고, 해당 수준들이 그 모집단에서 무작위로 추출되었다고 가정하는 요인들임. 이 요인들의 효과는 특정 값이 아니라 **분포(예: 정규 분포)**를 따른다고 가정함.</p>
                    <ul class="list-disc list-inside ml-5 space-y-2 text-slate-700">
                        <li>**예시**:
                            <ul class="list-disc list-inside ml-5 mt-1">
                                <li>**환자 ID**: 연구에 참여한 개별 환자들은 전체 환자 모집단에서 무작위로 추출된 것으로 간주됨. 각 환자마다 반응의 초기값이나 시간에 따른 변화율이 다를 수 있음.</li>
                                <li>**의료 기관**: 여러 병원에서 데이터를 수집할 때, 각 병원은 전체 병원 모집단에서 무작위로 추출된 것으로 간주될 수 있음.</li>
                            </ul>
                        </li>
                        <li>**주요 유형**:
                            <ul class="list-disc list-inside ml-5 mt-1">
                                <li>**랜덤 절편 (Random Intercept)**: 개체마다 종속 변수의 시작점(평균)이 다름을 모델링함. (예: 환자마다 초기 BPRS 점수가 다름)</li>
                                <li>**랜덤 기울기 (Random Slope)**: 개체마다 독립 변수(예: 시간)에 따른 종속 변수의 변화율(기울기)이 다름을 모델링함. (예: 환자마다 시간에 따른 BPRS 점수 감소 속도가 다름)</li>
                            </ul>
                        </li>
                        <li>**특징**:
                            <ul class="list-disc list-inside ml-5 mt-1">
                                <li>주로 **분산 성분(Variance Component)**으로 해석됨.</li>
                                <li>개체 간의 이질성을 설명하고, 개체 내 측정값 간의 상관성을 간접적으로 설명함.</li>
                            </ul>
                        </li>
                    </ul>
                </div>

                <div class="bg-white p-6 rounded-xl shadow-md content-card">
                    <h3 class="font-bold text-xl mb-3 text-green-700">상관성 가정 (Correlation Structure)</h3>
                    <p class="text-slate-600 text-sm mb-4">LMM에서 **상관성 가정**은 동일한 개체 내에서 반복 측정된 데이터 간의 종속성(상관관계)이 어떤 패턴을 가지는지 명시하는 것임. 이는 오차 항($\boldsymbol{\epsilon}_j$)의 공분산 구조를 정의하는 것과 관련이 있음. LMM은 RM ANOVA와 달리 구형성 가정을 요구하지 않으며, 다양한 상관 구조를 직접 모델링할 수 있음.</p>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-4 mt-4">
                        <div class="bg-green-50 p-4 rounded-md text-center">
                            <h4 class="font-semibold text-green-800 text-base mb-2">독립 (Independent)</h4>
                            $$
                            \begin{pmatrix}
                            1 & 0 & 0 \\
                            0 & 1 & 0 \\
                            0 & 0 & 1
                            \end{pmatrix}
                            $$
                        </div>
                        <div class="bg-green-50 p-4 rounded-md text-center">
                            <h4 class="font-semibold text-green-800 text-base mb-2">복합 대칭 (Compound Symmetry, CS)</h4>
                            $$
                            \begin{pmatrix}
                            1 & \rho & \rho \\
                            \rho & 1 & \rho \\
                            \rho & \rho & 1
                            \end{pmatrix}
                            $$
                        </div>
                        <div class="bg-green-50 p-4 rounded-md text-center">
                            <h4 class="font-semibold text-green-800 text-base mb-2">자기회귀 (Autoregressive, AR(1))</h4>
                            $$
                            \begin{pmatrix}
                            1 & \rho & \rho^2 \\
                            \rho & 1 & \rho \\
                            \rho^2 & \rho & 1
                            \end{pmatrix}
                            $$
                        </div>
                        <div class="bg-green-50 p-4 rounded-md text-center">
                            <h4 class="font-semibold text-green-800 text-base mb-2">비구조화 (Unstructured, UN)</h4>
                            $$
                            \begin{pmatrix}
                            1 & \rho_{12} & \rho_{13} \\
                            \rho_{12} & 1 & \rho_{23} \\
                            \rho_{13} & \rho_{23} & 1
                            \end{pmatrix}
                            $$
                        </div>
                    </div>
                    <p class="text-slate-600 text-sm mt-6">
                        올바른 상관 구조를 지정하는 것은 모형의 **정확한 표준 오차 추정**과 **가설 검정 결과**에 매우 중요함. 잘못된 상관 구조는 통계적 유의성 판단에 오류를 초래할 수 있음.
                    </p>
                </div>
            </div>
        </section>

        <section id="gee-deep-dive" class="mb-16 scroll-mt-20">
            <h2 class="text-3xl font-bold text-slate-800 mb-4 text-center">GEE (일반화 추정 방정식) 심층 이해</h2>
            <p class="text-lg text-slate-600 max-w-3xl mx-auto text-center mb-8">GEE는 일반화 선형 모형(Generalized Linear Model)의 확장으로, 반복측정 데이터에 특화된 분석 방법임. 특히 결과 변수가 정규 분포를 따르지 않는 경우에 유용하며, 모집단 평균에 대한 추론을 제공함.</p>

            <div class="grid md:grid-cols-1 gap-8">
                <div class="bg-white p-6 rounded-xl shadow-md content-card">
                    <h4 class="font-semibold text-purple-700 text-xl mb-2">GEE 모델 식</h4>
                    <p class="text-slate-600 text-sm mb-4">GEE는 링크 함수를 통해 평균 반응과 선형 예측 변수를 연결함. 이는 개체 내 상관성을 직접 모델링하지만, 랜덤 효과는 포함하지 않음.</p>
                    <div class="bg-purple-50 p-4 rounded-md">
                        <p class="text-slate-700 text-sm">
                            $$ g(E[Y_{ijk}]) = \beta_0 + \beta_1 X_{1ijk} + \dots + \beta_p X_{pijk} $$
                            여기서:
                            <ul class="list-disc list-inside ml-5 mt-2 space-y-1">
                                <li>$Y_{ijk}$: $k$번째 개체의 $i$번째 그룹에서 $j$번째 시점의 측정값</li>
                                <li>$E[Y_{ijk}]$: $Y_{ijk}$의 기대값</li>
                                <li>$g(\cdot)$: 링크 함수 (예: 로짓, 로그, 항등 함수 등)</li>
                                <li>$\beta_0$: 절편</li>
                                <li>$\beta_1, \dots, \beta_p$: 고정 효과 계수</li>
                                <li>$X_{1ijk}, \dots, X_{pijk}$: 설명 변수</li>
                            </ul>
                            GEE는 개체 내 상관성을 직접 모델링하지만, 랜덤 효과는 포함하지 않고 모집단 평균에 대한 추론을 제공함.
                        </p>
                    </div>
                </div>

                <div class="bg-white p-6 rounded-xl shadow-md content-card">
                    <h3 class="font-bold text-xl mb-3 text-purple-700">GEE의 주요 특징</h3>
                    <ul class="list-disc list-inside ml-5 space-y-2 text-slate-700">
                        <li>**결과 변수의 유연성**: 연속형 외에도 범주형(이항, 다항 등) 자료를 분석할 수 있음. 이는 LMM이 주로 연속형 결과 변수에 사용되는 것과 대조적임.</li>
                        <li>**결측치 처리**: LMM과 마찬가지로 결측치가 있어도 해당 개체를 분석에서 제외하지 않고 적용할 수 있음.</li>
                        <li>**상관 구조 선택**: 반복 요인 수준 간 상관 구조를 설정할 수 있음 (예: 독립, 복합 대칭, 자기회귀 등). LMM에 비해 상관 구조 선택에 덜 민감한 경향이 있음.</li>
                        <li>**정규성 가정의 유연성**: 결과 변수가 연속형일 때 정규성 가정을 다소 벗어나더라도 분석 결과에 영향을 덜 받음.</li>
                        <li>**모집단 평균 추론 (Population-average Inference)**: 개별 개체의 특성보다는 모집단 전체의 평균적인 변화 패턴에 초점을 맞춤.</li>
                        <li>**랜덤 효과 미고려**: LMM과 달리 개체별 랜덤 효과를 직접적으로 모형에 포함하지 않음.</li>
                    </ul>
                </div>

                <div class="bg-white p-6 rounded-xl shadow-md content-card">
                    <h3 class="font-bold text-xl mb-3 text-purple-700">상관성 가정 (Correlation Structure)</h3>
                    <p class="text-slate-600 text-sm mb-4">GEE에서 **상관성 가정**은 동일한 개체 내에서 반복 측정된 데이터 간의 종속성(상관관계)이 어떤 패턴을 가지는지 명시하는 것임. 이는 GEE가 표준 오차를 올바르게 추정하고 유효한 통계적 추론을 제공하는 데 중요함.</p>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-4 mt-4">
                        <div class="bg-purple-50 p-4 rounded-md text-center">
                            <h4 class="font-semibold text-purple-800 text-base mb-2">독립 (Independent)</h4>
                            $$
                            \begin{pmatrix}
                            1 & 0 & 0 \\
                            0 & 1 & 0 \\
                            0 & 0 & 1
                            \end{pmatrix}
                            $$
                        </div>
                        <div class="bg-purple-50 p-4 rounded-md text-center">
                            <h4 class="font-semibold text-purple-800 text-base mb-2">복합 대칭 (Compound Symmetry, CS)</h4>
                            $$
                            \begin{pmatrix}
                            1 & \rho & \rho \\
                            \rho & 1 & \rho \\
                            \rho & \rho & 1
                            \end{pmatrix}
                            $$
                        </div>
                        <div class="bg-purple-50 p-4 rounded-md text-center">
                            <h4 class="font-semibold text-purple-800 text-base mb-2">자기회귀 (Autoregressive, AR(1))</h4>
                            $$
                            \begin{pmatrix}
                            1 & \rho & \rho^2 \\
                            \rho & 1 & \rho \\
                            \rho^2 & \rho & 1
                            \end{pmatrix}
                            $$
                        </div>
                        <div class="bg-purple-50 p-4 rounded-md text-center">
                            <h4 class="font-semibold text-purple-800 text-base mb-2">비구조화 (Unstructured, UN)</h4>
                            $$
                            \begin{pmatrix}
                            1 & \rho_{12} & \rho_{13} \\
                            \rho_{12} & 1 & \rho_{23} \\
                            \rho_{13} & \rho_{23} & 1
                            \end{pmatrix}
                            $$
                        </div>
                    </div>
                    <p class="text-slate-600 text-sm mt-6">
                        올바른 상관 구조를 지정하는 것은 모형의 **정확한 표준 오차 추정**과 **가설 검정 결과**에 매우 중요함. 잘못된 상관 구조는 통계적 유의성 판단에 오류를 초래할 수 있음.
                    </p>
                </div>
            </div>
        </section>

        <section id="r-guides" class="mb-16 scroll-mt-20">
            <h2 class="text-3xl font-bold text-slate-800 mb-4 text-center">R을 이용한 실습 가이드</h2>
            <p class="text-lg text-slate-600 max-w-3xl mx-auto text-center mb-8">R은 통계 분석 및 데이터 시각화에 널리 사용되는 강력한 오픈소스 프로그래밍 언어임. 여기서는 RM ANOVA, LMM, GEE를 R에서 어떻게 실행하는지 코드 예제와 함께 안내함. 필요한 패키지 설치 및 데이터 준비부터 분석 실행까지의 과정을 다룸.</p>

            <div class="grid md:grid-cols-1 gap-8">
                <div class="bg-white p-6 rounded-xl shadow-md content-card">
                    <h3 class="font-bold text-2xl mb-4 text-blue-700">RM ANOVA R 사용법</h3>
                    <ol class="list-decimal list-inside space-y-4 text-slate-700">
                        <li>**실습 목표**:
                            <ul class="list-disc list-inside ml-5 mt-2 space-y-1">
                                <li>Wide → Long 데이터 변환</li>
                                <li>일변량 접근으로 RM ANOVA</li>
                                <li>구형성 검정/보정(GG, HF)</li>
                                <li>다변량 검정으로 RM ANOVA </li>
                                <li>사후분석 및 단순효과: `emmeans`</li>
                                <li>혼합모형(LMM) 대안</li>
                            </ul>
                        </li>
                        <li>**재현 가능한 예제 데이터 만들기 (Wide 형식)**:
                            <pre><code>set.seed(123)

data_wide &lt;- data.frame(
  id    = 1:40,
  group = rep(c("A", "P"), each = 20),
  t0    = rnorm(40, mean = 50, sd = 10),
  t1    = rnorm(40, mean = 45, sd = 10),
  t2    = rnorm(40, mean = 40, sd = 10),
  t3    = rnorm(40, mean = 35, sd = 10)
)

str(data_wide)
head(data_wide, 3)</code></pre>
                        </li>
                        <li>**Long 형식으로 변환**:
                            <pre><code># 필요한 패키지
# install.packages(c("tidyr","dplyr","ggplot2"))
library(tidyr); library(dplyr); library(ggplot2)

long_data &lt;- data_wide |&gt;
  pivot_longer(cols = t0:t3, names_to = "time", values_to = "response") |&gt;
  mutate(
    group = factor(group),
    id    = factor(id),
    #시간은 순서가 있는 요인으로(구형성 검정 등에서 중요)
    time  = factor(time, levels = c("t0","t1","t2","t3"), ordered = TRUE)
  )

str(long_data)
head(long_data, 6)</code></pre>
                        </li>
                        <li>**기초 시각화 (그룹×시간 평균 추이)**:
                            <pre><code>summary_df &lt;- long_data |&gt;
  group_by(group, time) |&gt;
  summarise(mean = mean(response), se = sd(response)/sqrt(n()), .groups = "drop")

ggplot(summary_df, aes(x = time, y = mean, group = group)) +
  geom_line(aes(linetype = group)) +
  geom_point(aes(shape = group), size = 2) +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se), width = 0.1) +
  labs(y = "Mean ± SE", x = "Time", linetype = "Group", shape = "Group",
       title = "RM ANOVA 실습: 그룹별 시간 변화") +
  theme_bw()</code></pre>
                            <img src="https://googleusercontent.com/file_content/1" alt="RM ANOVA 실습: 그룹별 시간 변화" class="spss-image">
                        </li>
                        <li>**전통적 RM ANOVA **:
                            <pre><code># RM ANOVA: Subject(=id) 내에서 time 반복
fit_aov &lt;- aov(response ~ group * time + Error(id/time), data = long_data)
summary(fit_aov)</code></pre>
                            <p class="text-sm text-slate-600 mt-2"></p>
                        </li>
                        <li>**Wide 자료에서 다변량 접근**:
                            <pre><code># install.packages("car")
library(car)

# (1) wide-형식 다변량 회귀 모형 적합
lm_mod &lt;- lm(cbind(t0, t1, t2, t3) ~ group, data = data_wide)

# (2) 반복측정 요인에 대한 idata/idesign 지정
idata &lt;- data.frame(time = factor(c("t0","t1","t2","t3"),
                                 levels = c("t0","t1","t2","t3"),
                                 ordered = TRUE))

# (3) MANOVA 기반 RM ANOVA
# multivariate=FALSE 로 두면(기본) univariate tests + 구형성 보정(Mauchly/GG/HF)을 함께 제공
car_rm &lt;- Anova(lm_mod, idata = idata, idesign = ~ time, type = "III")
car_rm
summary(car_rm, multivariate = TRUE) # Pillai 등 다변량 통계량</code></pre>
                            <p class="text-sm text-slate-600 mt-2">time 주효과와 group:time 상호작용이 within-subject 효과임. multivariate=TRUE 요약은 구형성 가정 없이 다변량 통계량(Pillai, Wilks 등)을 보여줌.</p>
                        </li>
                        <li>**구형성 검정 : afex**:
                            <pre><code># install.packages(c("afex","emmeans"))
library(afex); library(emmeans)

# id = 피험자, dv = 종속변수, within = 반복요인, between = 집단 요인
fit_afex &lt;- aov_ez(
  id = "id",
  dv = "response",
  within = "time",
  between = "group",
  data = long_data,
  type = 3
)
fit_afex       # Mauchly's test, GG/HF 보정 p-value 포함
nice(fit_afex) # 보기 좋은 요약표</code></pre>
                            <p class="text-sm text-slate-600 mt-2">보고서/논문용으로는 `afex` 출력(구형성 검정 + 보정 p값)이 가장 편리함.</p>
                        </li>
                        <li>**사후분석(단순효과 & 대비): `emmeans`**:
                            <pre><code># 시간별 그룹 차이(단순효과)
emm_time_by_grp &lt;- emmeans(fit_afex, ~ group | time)
pairs(emm_time_by_grp, adjust = "bonferroni")

# 그룹별 시간 내 비교(시간 변화의 단순효과)
emm_grp_by_time &lt;- emmeans(fit_afex, ~ time | group)
pairs(emm_grp_by_time, adjust = "bonferroni")

# 선형 대비(예: 시간의 선형 트렌드 차이, group 간)
contrast(emmeans(fit_afex, ~ time | group), "poly")</code></pre>
                        </li>
                        <li>**효과크기**:
                            <pre><code># install.packages("effectsize")
library(effectsize)

eta_squared(fit_aov, partial = TRUE) 
# afex 객체에서도 effectsize::eta_squared(), omega_squared() 사용 가능</code></pre>
                        </li>
                        <li>**혼합모형(LMM) 대안: 불균형/결측/시간간격 불규칙에 유리**:
                            <pre><code># install.packages(c("lme4","lmerTest"))
library(lme4); library(lmerTest)

# 랜덤 절편 모형
fit_lmm1 &lt;- lmer(response ~ group * time + (1 | id), data = long_data)
anova(fit_lmm1)

# 랜덤 절편 + 랜덤 기울기(시간별 개인차)
fit_lmm2 &lt;- lmer(response ~ group * time + (time | id), data = long_data)
anova(fit_lmm1, fit_lmm2) # 모형 비교

summary(fit_lmm2)
emmeans(fit_lmm2, ~ group | time) |&gt; pairs()</code></pre>
                            <p class="text-sm text-slate-600 mt-2">LMM은 구형성 가정이 불필요하고, 결측/불균형 데이터에 강인함.</p>
                        </li>
                        <li>**자주 생기는 오류와 해결법**:
                            <ul class="list-disc list-inside ml-5 mt-2 space-y-1">
                                <li>`Anova()` 인자 오타/누락: `idesign = ~ time_factor`를 반드시 넣어야 함. `idata`의 행 수 = `cbind`에 묶은 반복측정 열의 개수(여기선 4).</li>
                                <li>요인형 변환 누락: `group`, `id`, `time`은 factor여야 함(특히 `time`은 ordered factor 권장).</li>
                                <li>열 순서/레벨 불일치: `idata`의 `time` 레벨 순서가 `cbind(t0,t1,t2,t3)`의 열 순서와 일치해야 함.</li>
                                <li>결측/불균형: `aov(Error(id/time))`은 결측에 취약함. 결측이 있으면 LMM이 더 나음.</li>
                                <li>구형성 가정: 전통적 RM ANOVA는 구형성 가정을 전제함. GG/HF 보정 p값을 함께 보고해야 함.</li>
                            </ul>
                        </li>
                        <li>**보고/해석 가이드(간단 예시)**:
                            <ul class="list-disc list-inside ml-5 mt-2 space-y-1">
                                <li>**주효과(time)**: 시간에 따라 평균이 유의하게 변화하는지 여부.</li>
                                <li>**상호작용(group×time)**: 두 그룹의 시간에 따른 변화 패턴이 다른지 여부.
                                    <ul class="list-disc list-inside ml-5 mt-1">
                                        <li>유의하면 단순효과(시간별 그룹 비교 또는 그룹별 시간 비교)로 해석/보고함.</li>
                                    </ul>
                                </li>
                            </ul>
                        </li>
                    </ol>
                </div>

                <div class="bg-white p-6 rounded-xl shadow-md content-card">
                    <h3 class="font-bold text-2xl mb-4 text-green-700">LMM R 사용법</h3>
                    <ol class="list-decimal list-inside space-y-3 text-slate-700">
                        <li>**패키지 로드**:
                            <pre><code># install.packages(c("tidyr","dplyr","ggplot2","nlme"))
library(tidyr); library(dplyr);
library(ggplot2); library(nlme)</code></pre>
                        </li>
                        <li>**예시 데이터 (wide) 생성**:
                            <pre><code>set.seed(123)
data_wide &lt;- data.frame(
  id    = 1:40,
  group = rep(c("A","P"), each = 20),
  t0    = rnorm(40, mean = 50, sd = 10),
  t1    = rnorm(40, mean = 45, sd = 10),
  t2    = rnorm(40, mean = 40, sd = 10),
  t3    = rnorm(40, mean = 35, sd = 10)
)</code></pre>
                        </li>
                        <li>**wide → long 변환**:
                            <pre><code>long_data_lmm &lt;- data_wide %&gt;%
  pivot_longer(cols = starts_with("t"),
               names_to = "time_char", values_to = "response_value") %&gt;%
  mutate(
    time    = as.numeric(sub("^t","", time_char)),      # 0,1,2,3 (숫자)
    time_f  = factor(time_char, levels = c("t0","t1","t2","t3"), ordered = TRUE),
    id      = factor(id),
    group   = factor(group)
  ) %&gt;%
  select(id, group, time, time_f, response_value)</code></pre>
                        </li>
                        <li>**그림 1: 스파게티 + 그룹 평균선**:
                            <pre><code>p1 &lt;- ggplot(long_data_lmm, aes(x = time, y = response_value, group = id, color = group)) +
  geom_line(alpha = 0.35) +
  # 그룹 평균선(굵게)
  stat_summary(aes(group = group, color = group),
               fun = mean, geom = "line", linewidth = 1.3) +
  labs(title = "Spaghetti plot with group mean trajectories",
       x = "Time (visit)", y = "Response") +
  theme_bw()

print(p1)
# ggsave("rm_spaghetti_R.png", p1, width = 8, height = 5, dpi = 200) # 파일 저장 (실행하지 않음)</code></pre>
                        </li>
                        <li>**그림 2: 그룹×시간 평균 ± SE**:
                            <pre><code>summary_df &lt;- long_data_lmm %&gt;%
  group_by(group, time) %&gt;%
  summarise(mean = mean(response_value),
            se   = sd(response_value) / sqrt(n()),
            .groups = "drop")

p2 &lt;- ggplot(summary_df,
             aes(x = time, y = mean, group = group, shape = group, linetype = group)) +
  geom_line(linewidth = 1.2) +
  geom_point(size = 2) +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se), width = 0.08) +
  labs(title = "Group × Time means ± SE",
       x = "Time (visit)", y = "Mean response") +
  theme_bw()

print(p2)
# ggsave("rm_means_se_R.png", p2, width = 8, height = 5, dpi = 200) # 파일 저장 (실행하지 않음)</code></pre>
                        </li>
                        <li>**AR(1) LMM 적합: time_f(범주형) + AR(1){time(숫자)}**:
                            <pre><code>fit_cat_ar1 &lt;- nlme::lme(fixed       = response_value ~ group * time_f,    # time_f: 범주형
                         random      = ~ 1 | id,                           # 랜덤 절편
                         correlation = nlme::corAR1(form = ~ time | id), # 숫자 time 기반 AR(1)
                         data        = long_data_lmm,
                         method      = "REML"
)

anova(fit_cat_ar1)
summary(fit_cat_ar1)</code></pre>
                        </li>
                        <li>**사후 분석**:
                            <pre><code># install.packages("emmeans")
library(emmeans)

# 시간별 그룹 차이
emm_g_by_t &lt;- emmeans(fit_cat_ar1, ~ group | time_f)
pairs(emm_g_by_t, adjust = "holm")

# 그룹별 시간 차이
emm_t_by_g &lt;- emmeans(fit_cat_ar1, ~ time_f | group)
pairs(emm_t_by_g, adjust = "holm")</code></pre>
                        </li>
                    </ol>
                </div>

                <div class="bg-white p-6 rounded-xl shadow-md content-card">
                    <h3 class="font-bold text-2xl mb-4 text-purple-700">GEE (일반화 추정 방정식) R 사용법</h3>
                    <p class="text-slate-600 mb-4">GEE는 `geepack` 패키지의 `geeglm()` 함수를 주로 사용함. 범주형 결과 변수에 특히 유용하며, 데이터는 Long format으로 준비되어야 함.</p>
                    <ol class="list-decimal list-inside space-y-3 text-slate-700">
                        <li>**데이터 준비 (Long Format)**:
                            <p class="text-sm text-slate-600 mt-2">LMM과 동일하게 Long format 데이터가 필요함. `response_binary`와 같은 이항형 결과 변수를 포함함.</p>
                            <pre><code># 예시 데이터 생성 (이항 결과 변수)
# long_data_gee는 LMM 예시의 long_data_lmm에서 파생
long_data_gee &lt;- long_data_lmm %&gt;%
  mutate(response_binary = rbinom(n(), 1, prob = ifelse(group == "A", 0.3 + 0.05*time/max(time), 0.5 - 0.05*time/max(time))),
         time = factor(time)) # GEE에서는 time을 factor로 사용하는 경우가 많음
print(head(long_data_gee))</code></pre>
                        </li>
                        <li>**GEE 실행**:
                            <p class="text-sm text-slate-600 mt-2">`geepack` 패키지의 `geeglm()` 함수를 사용하여 일반화 추정 방정식을 실행함. `family`와 `corstr` (상관 구조)를 지정하는 것이 중요함.</p>
                            <pre><code># 필요한 패키지 설치 및 로드
# install.packages("geepack")
library(geepack)

# GEE 모델 실행 (이항 결과, 로짓 링크, AR(1) 상관 구조)
# response_binary ~ group * time
# family = binomial(link = "logit")
# id = id, corstr = "ar1" (AR(1) 상관 구조)
model_gee &lt;- geeglm(response_binary ~ group * time,
                     data = long_data_gee,
                     id = id,
                     family = binomial(link = "logit"),
                     corstr = "ar1")
summary(model_gee)</code></pre>
                        </li>
                        <li>**결과 시각화 (예시)**:
                            <p class="text-sm text-slate-600 mt-2">그룹별 시간에 따른 이항형 결과 변수의 비율 변화를 막대 그래프 등으로 시각화함.</p>
                            <pre><code># install.packages("ggplot2")
library(ggplot2)

# 그룹별 시간별 평균 비율 계산
summary_data &lt;- long_data_gee %&gt;%
  group_by(group, time) %&gt;%
  summarise(mean_response = mean(response_binary, na.rm = TRUE))

ggplot(summary_data, aes(x = time, y = mean_response, fill = group)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(title = "GEE: 그룹별 시간에 따른 이항 반응 비율", x = "시간 (시점)", y = "반응 비율") +
  theme_minimal() +
  scale_fill_manual(values = c("A" = "purple", "P" = "orange"))</code></pre>
                        </li>
                    </ol>
                </div>
            </div>
        </section>

        <section id="case-studies" class="mb-16 scroll-mt-20">
            <h2 class="text-3xl font-bold text-slate-800 mb-2 text-center">사례 살펴보기</h2>
            <p class="text-lg text-slate-600 max-w-3xl mx-auto text-center mb-8">실제 연구 사례를 통해 각 분석 방법의 적용과 결과 해석을 확인해 볼 수 있음.</p>
            <div class="text-center mb-6">
                <select id="case-study-selector" class="p-2 border rounded-md shadow-sm">
                    <option value="tlc">사례 1: 납 노출 아동 치료 연구 (RM ANOVA)</option>
                    <option value="bprs">사례 2: BPRS 점수 변화 연구 (LMM)</option>
                    <option value="child-health">사례 3: 아동 건강 연구 (GEE)</option>
                </select>
            </div>
            <div class="bg-white p-6 md:p-8 rounded-xl shadow-lg">
                <div id="case-study-content"></div>
            </div>
        </section>

        <section id="required-packages" class="mb-16 scroll-mt-20">
            <h2 class="text-3xl font-bold text-slate-800 mb-4 text-center">필요 패키지</h2>
            <p class="text-lg text-slate-600 max-w-3xl mx-auto text-center mb-8">R을 이용한 다시점 자료 분석을 위해 필요한 패키지 설치 명령어들임. 각 분석 방법에 따라 필요한 패키지를 설치해 볼 수 있음.</p>
            
            <div class="grid md:grid-cols-1 gap-8">
                <div class="bg-white p-6 rounded-xl shadow-md content-card">
                    <h3 class="font-bold text-xl mb-3 text-blue-700">공통 및 데이터 조작/시각화</h3>
                    <pre><code>install.packages(c("tidyr", "dplyr", "ggplot2"))</code></pre>
                    <ul class="list-disc list-inside text-sm space-y-1 text-slate-700 mt-4">
                        <li>`tidyr`: 데이터 형태를 wide에서 long으로 변환하는 등 데이터 정리에 필수적인 패키지임.</li>
                        <li>`dplyr`: 데이터 필터링, 그룹화, 요약 등 데이터 조작에 강력한 기능을 제공하는 패키지임.</li>
                        <li>`ggplot2`: 고품질의 통계 그래프를 생성하는 데 사용되는 시각화 패키지임.</li>
                    </ul>
                </div>
                <div class="bg-white p-6 rounded-xl shadow-md content-card">
                    <h3 class="font-bold text-xl mb-3 text-green-700">RM ANOVA 관련</h3>
                    <pre><code>install.packages(c("ez", "car", "afex", "emmeans", "effectsize"))</code></pre>
                    <ul class="list-disc list-inside text-sm space-y-1 text-slate-700 mt-4">
                        <li>`ez`: RM ANOVA를 쉽게 수행할 수 있는 함수 `ezANOVA()`를 제공하는 패키지임.</li>
                        <li>`car`: `Anova()` 함수를 통해 다변량 접근 방식의 RM ANOVA를 포함한 다양한 분산 분석을 지원하는 패키지임.</li>
                        <li>`afex`: `aov_ez()` 함수를 통해 구형성 검정 및 보정(Greenhouse-Geisser, Huynh-Feldt)을 편리하게 수행할 수 있도록 하는 패키지임.</li>
                        <li>`emmeans`: 복잡한 모델의 사후 분석(post-hoc tests) 및 단순 효과(simple effects) 분석을 위한 강력한 도구임.</li>
                        <li>`effectsize`: 효과 크기(예: 부분 에타 제곱)를 계산하는 기능을 제공하는 패키지임.</li>
                    </ul>
                </div>
                <div class="bg-white p-6 rounded-xl shadow-md content-card">
                    <h3 class="font-bold text-xl mb-3 text-purple-700">LMM 및 GEE 관련</h3>
                    <pre><code>install.packages(c("nlme", "lme4", "lmerTest", "geepack"))</code></pre>
                    <ul class="list-disc list-inside text-sm space-y-1 text-slate-700 mt-4">
                        <li>`nlme`: 선형 및 비선형 혼합 효과 모델(`lme`, `nlme`)을 적합하는 데 사용됨. 다양한 상관 구조를 명시적으로 지정할 수 있는 패키지임.</li>
                        <li>`lme4`: 선형 및 일반화 선형 혼합 모델(`lmer`, `glmer`)을 적합하는 데 주로 사용되는 패키지임. `nlme`보다 더 유연하고 효율적임.</li>
                        <li>`lmerTest`: `lme4` 모델에 대한 p-값 및 자유도를 계산하여 `summary()` 및 `anova()` 출력에 추가하는 패키지임.</li>
                        <li>`geepack`: 일반화 추정 방정식(`geeglm()`)을 사용하여 상관된 이항 또는 다른 비정규 분포 데이터를 분석하는 데 사용되는 패키지임.</li>
                    </ul>
                </div>
            </div>
        </section>

        <section id="summary" class="scroll-mt-20">
            <h2 class="text-3xl font-bold text-slate-800 mb-2 text-center">핵심 요약 및 의사결정 가이드</h2>
            <p class="text-lg text-slate-600 max-w-3xl mx-auto text-center mb-8">내 연구에 가장 적합한 분석 방법은 무엇인지 확인해 볼 수 있음.</p>
            <div class="grid lg:grid-cols-2 gap-8">
                <div class="bg-white p-6 rounded-xl shadow-md content-card">
                    <h3 class="font-bold text-xl mb-4 text-blue-700">한눈에 보는 비교표</h3>
                    <div class="overflow-x-auto">
                        <table class="w-full text-sm text-left">
                            <thead class="bg-slate-100 text-slate-600">
                                <tr>
                                    <th class="p-3">분석 방법</th>
                                    <th class="p-3">결과 변수</th>
                                    <th class="p-3">결측치 처리</th>
                                    <th class="p-3">랜덤 효과</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="border-b">
                                    <td class="p-3 font-semibold">RM ANOVA</td>
                                    <td class="p-3">연속형</td>
                                    <td class="p-3">불가능 (개체 제외)</td>
                                    <td class="p-3">불가능</td>
                                </tr>
                                <tr class="border-b">
                                    <td class="p-3 font-semibold">LMM</td>
                                    <td class="p-3">연속형</td>
                                    <td class="p-3">가능</td>
                                    <td class="p-3">가능</td>
                                </tr>
                                <tr>
                                    <td class="p-3 font-semibold">GEE</td>
                                    <td class="p-3">범주형/연속형</td>
                                    <td class="p-3">가능</td>
                                    <td class="p-3">불가능</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="bg-white p-6 rounded-xl shadow-md content-card">
                    <h3 class="font-bold text-xl mb-4 text-blue-700">분석 방법 선택 가이드</h3>
                    <div class="space-y-3 text-sm">
                        <div class="flex items-center">
                            <div class="bg-blue-100 text-blue-800 p-3 rounded-lg w-full">Q1. 결과 변수가 연속형인가?</div>
                        </div>
                        <div class="ml-4 flex items-center">
                            <span class="mr-2">↳</span>
                            <div class="bg-slate-100 p-2 rounded-md">아니오 (범주형)</div>
                            <span class="mx-2">→</span>
                            <div class="bg-purple-100 text-purple-800 p-2 rounded-md font-semibold">GEE 사용</div>
                        </div>
                         <div class="ml-4 flex items-center">
                            <span class="mr-2">↳</span>
                            <div class="bg-slate-100 p-2 rounded-md">예</div>
                        </div>
                        <div class="ml-8 flex items-center">
                             <div class="bg-blue-100 text-blue-800 p-3 rounded-lg w-full">Q2. 데이터에 결측치가 있는가?</div>
                        </div>
                        <div class="ml-12 flex items-center">
                            <span class="mr-2">↳</span>
                            <div class="bg-slate-100 p-2 rounded-md">아니오</div>
                            <span class="mx-2">→</span>
                            <div class="bg-blue-100 text-blue-800 p-2 rounded-md font-semibold">RM ANOVA 또는 LMM</div>
                        </div>
                        <div class="ml-12 flex items-center">
                            <span class="mr-2">↳</span>
                            <div class="bg-slate-100 p-2 rounded-md">예</div>
                            <span class="mx-2">→</span>
                            <div class="bg-green-100 text-green-800 p-2 rounded-md font-semibold">LMM 또는 GEE</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const caseStudyData = {
                tlc: {
                    title: '사례 1: 납 노출 아동 치료 연구',
                    method: 'RM ANOVA',
                    description: '혈중 납 농도가 높은 아동을 치료군(A)과 위약군(P)으로 나누어 0, 2, 4, 6주차 혈중 납 농도를 측정했음. 이 사례는 결측치가 없는 완전한 데이터로, 전통적인 RM ANOVA를 적용하기에 적합함.',
                    results: [
                        { label: '시간 효과 (Time)', value: 'p < 0.001', interpretation: '시간에 따라 혈중 납 농도는 유의하게 변화했음.' },
                        { label: '그룹 효과 (Group)', value: 'p = 0.907', interpretation: '치료군과 위약군 간 평균 농도에 유의한 차이는 없었음.' },
                        { label: '교호작용 효과 (Time*Group)', value: 'p = 0.321', interpretation: '시간에 따른 농도 변화 양상은 두 그룹 간에 유의한 차이가 없었음.' }
                    ],
                    chart: {
                        type: 'line',
                        labels: ['0주차', '2주차', '4주차', '6주차'],
                        datasets: [
                            { label: '치료군 (A)', data: [26.5, 14.8, 19.5, 21.0], borderColor: 'rgba(59, 130, 246, 1)', backgroundColor: 'rgba(59, 130, 246, 0.2)', fill: false, tension: 0.1 },
                            { label: '위약군 (P)', data: [30.8, 26.9, 25.8, 23.8], borderColor: 'rgba(239, 68, 68, 1)', backgroundColor: 'rgba(239, 68, 68, 0.2)', fill: false, tension: 0.1 }
                        ],
                        options: { yAxisLabel: '혈중 납 농도 (㎍/dL)' }
                    }
                },
                bprs: {
                    title: '사례 2: BPRS 점수 변화 연구',
                    method: 'LMM (선형 혼합 모형)',
                    description: '정신분열증 의심 환자를 두 그룹으로 나누어 8주간 BPRS(정신과적 평가 척도) 점수를 측정했음. 일부 데이터에 결측치가 있고, 환자별 초기 점수와 변화율이 다를 수 있으므로 LMM이 적합함.',
                    results: [
                        { label: '시간 효과 (Time)', value: 'p < 0.001', interpretation: '시간에 따라 BPRS 점수는 유의하게 감소했음.' },
                        { label: '그룹 효과 (Group)', value: 'p = 0.621', interpretation: '두 치료 그룹 간 평균 BPRS 점수에 유의한 차이는 없었음.' },
                        { label: '교호작용 효과 (Group*Time)', value: 'p = 0.435', interpretation: '시간에 따른 점수 변화 양상은 두 그룹 간에 유의한 차이가 없었음.' }
                    ],
                    chart: {
                        type: 'line',
                        labels: ['0주', '1주', '2주', '3주', '4주', '5주', '6주', '7주', '8주'],
                        datasets: [
                            { label: '그룹 1', data: [47.0, 46.8, 43.5, 40.9, 36.6, 32.7, 29.7, 29.8, 29.3], borderColor: 'rgba(16, 185, 129, 1)', backgroundColor: 'rgba(16, 185, 129, 0.2)', fill: false, tension: 0.1 },
                            { label: '그룹 2', data: [47.3, 45.8, 39.8, 37.4, 36.1, 32.4, 32.7, 34.6, 33.5], borderColor: 'rgba(249, 115, 22, 1)', backgroundColor: 'rgba(249, 115, 22, 0.2)', fill: false, tension: 0.1 }
                        ],
                        options: { yAxisLabel: 'BPRS 점수' }
                    }
                },
                'child-health': {
                    title: '사례 3: 아동 건강 연구',
                    method: 'GEE (일반화 추정 방정식)',
                    description: '비타민 A 결핍 여부와 호흡기 질환 발생의 관계를 알아보기 위해 275명의 아동을 반복 측정했음. 결과 변수인 "호흡기 질환 발생 여부"가 예/아니오 형태의 범주형 데이터이므로 GEE가 가장 적합함.',
                    results: [
                        { label: '비타민 A 효과 (VITA)', value: 'p = 0.203', interpretation: '성별과 나이를 보정했을 때, 비타민 A 결핍 여부는 호흡기 질환 발생 가능성에 유의한 영향을 미치지 않았음.' },
                        { label: '시간 효과 (Time)', value: 'p = 0.318', interpretation: '시간 경과에 따른 호흡기 질환 발생 가능성에 유의한 변화는 없었음.' },
                        { label: '교호작용 효과 (Time*VITA)', value: 'p = 0.829', interpretation: '시간에 따른 질환 발생률 변화 양상은 비타민 A 결핍 그룹과 정상 그룹 간에 유의한 차이가 없었음.' }
                    ],
                    chart: {
                        type: 'bar',
                        labels: ['0개월', '3개월', '6개월', '9개월', '12개월', '15개월'],
                        datasets: [
                            { label: '비타민 결핍(Yes)', data: [31.87, 30.77, 34.07, 36.26, 32.97, 35.16], backgroundColor: 'rgba(168, 85, 247, 0.7)' },
                            { label: '비타핍 결핍(No)', data: [23.9, 25.16, 29.56, 25.79, 28.93, 30.82], backgroundColor: 'rgba(96, 165, 250, 0.7)' }
                        ],
                        options: { yAxisLabel: '호흡기 질환 환자 비율 (%)' }
                    }
                }
            };
            
            let currentChart = null;

            function renderCaseStudy(caseKey) {
                const data = caseStudyData[caseKey];
                const contentEl = document.getElementById('case-study-content');
                
                let resultsHtml = data.results.map(res => `
                    <div class="border-t border-slate-200 pt-4 mt-4">
                        <div class="flex justify-between items-baseline">
                            <h4 class="font-semibold text-slate-700">${res.label}</h4>
                            <span class="text-sm font-bold ${res.value.includes('<') ? 'text-blue-600' : 'text-slate-500'}">${res.value}</span>
                        </div>
                        <p class="text-sm text-slate-500 mt-1">${res.interpretation}</p>
                    </div>
                `).join('');

                contentEl.innerHTML = `
                    <div class="grid lg:grid-cols-2 gap-8">
                        <div>
                            <h3 class="text-2xl font-bold text-slate-800">${data.title}</h3>
                            <p class="text-sm font-semibold text-white px-3 py-1 rounded-full inline-block mt-2 ${data.method === 'RM ANOVA' ? 'bg-blue-500' : data.method === 'LMM' ? 'bg-green-500' : 'bg-purple-500'}">${data.method}</p>
                            <p class="mt-4 text-slate-600">${data.description}</p>
                            <div class="mt-6">${resultsHtml}</div>
                        </div>
                        <div>
                            <div class="chart-container">
                                <canvas id="case-study-chart"></canvas>
                            </div>
                        </div>
                    </div>
                `;
                
                renderChart(data.chart);
            }

            function renderChart(chartData) {
                if (currentChart) {
                    currentChart.destroy();
                }
                const ctx = document.getElementById('case-study-chart').getContext('2d');
                currentChart = new Chart(ctx, {
                    type: chartData.type,
                    data: {
                        labels: chartData.labels,
                        datasets: chartData.datasets
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: chartData.options.yAxisLabel
                                }
                            }
                        },
                        plugins: {
                            legend: {
                                position: 'top',
                            },
                            tooltip: {
                                mode: 'index',
                                intersect: false,
                            }
                        },
                        interaction: {
                            mode: 'nearest',
                            axis: 'x',
                            intersect: false
                        }
                    }
                });
            }

            const caseSelector = document.getElementById('case-study-selector');
            caseSelector.addEventListener('change', (e) => renderCaseStudy(e.target.value));
            
            const tabButtons = document.querySelectorAll('#tab-buttons .tab-btn'); // Select buttons specifically within #tab-buttons
            const comparisonTabPanes = document.querySelectorAll('#tab-content .tab-pane'); // Select tab panes specifically within #tab-content

            tabButtons.forEach(button => {
                button.addEventListener('click', () => {
                    tabButtons.forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');
                    
                    const tabId = button.dataset.tab;
                    comparisonTabPanes.forEach(pane => {
                        if (pane.id === tabId) {
                            pane.classList.remove('hidden');
                        } else {
                            pane.classList.add('hidden');
                        }
                    });
                });
            });

            const navLinks = document.querySelectorAll('.nav-link');
            const sections = document.querySelectorAll('section');

            window.addEventListener('scroll', () => {
                let current = '';
                const headerHeight = 80; // Assuming header height is 80px

                // Iterate through sections to find which one is currently in view
                // We go from bottom to top to prioritize sections higher up when multiple are partially visible
                for (let i = sections.length - 1; i >= 0; i--) {
                    const section = sections[i];
                    const rect = section.getBoundingClientRect();
                    // If the top of the section is within the viewport (or just below the sticky header)
                    // and its bottom is also visible, or it's the first section and its top is visible
                    if (rect.top <= headerHeight && rect.bottom > headerHeight) { // Section is fully or partially under the header
                        current = section.getAttribute('id');
                        break;
                    }
                }

                // If no section is found (e.g., at very top of page), default to intro
                if (!current && window.scrollY < headerHeight) {
                    current = 'intro';
                }

                navLinks.forEach(link => {
                    link.classList.remove('active');
                    if (link.getAttribute('href').substring(1) === current) {
                        link.classList.add('active');
                    }
                });
            });
            
            navLinks.forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    const targetId = this.getAttribute('href');
                    const targetElement = document.querySelector(targetId);

                    if (targetElement && typeof targetElement.scrollIntoView === 'function') {
                        // Calculate the offset to account for the sticky header
                        const headerOffset = 80; // Height of your sticky header
                        const elementPosition = targetElement.getBoundingClientRect().top + window.pageYOffset;
                        const offsetPosition = elementPosition - headerOffset;

                        window.scrollTo({
                            top: offsetPosition,
                            behavior: "smooth"
                        });
                    } else {
                        console.error(`Error: Target element with ID "${targetId}" not found or scrollIntoView not available.`);
                    }
                });
            });

            // Initialize by showing RM ANOVA comparison content by default
            const initialTabButton = document.querySelector('.tab-btn[data-tab="rm-anova-tab"]');
            if (initialTabButton) {
                initialTabButton.classList.add('active');
                const initialTabPane = document.getElementById('rm-anova-tab');
                if (initialTabPane) {
                    initialTabPane.classList.remove('hidden');
                }
            }
            renderCaseStudy('tlc');
        });
    </script>
</body>
</html>
